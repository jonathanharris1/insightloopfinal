<!doctype html>
<html lang="pt-BR">
<head>
<!-- Basic document metadata -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>InsightLoop ‚Äî Customer Success Intelligence</title>
<meta name="description" content="Plataforma B2B SaaS para E-commerce Customer Success ‚Äî An√°lise de tickets e automa√ß√£o com IA" />
<meta name="turbo-cache-control" content="no-cache" />

<!-- Fonts / CSS (replace with your toolchain or Tailwind build) -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet" />
<!-- TODO: replace with your app.css or Tailwind output -->
<link rel="stylesheet" href="/assets/styles.css" />


<!-- Open Graph (kept minimal) -->
<meta property="og:title" content="InsightLoop - Customer Success Intelligence" />
<meta property="og:description" content="An√°lises e automa√ß√£o para atendimento ao cliente de e-commerce" />

<!-- JS entry (defer) -->
<script defer src="/assets/app.js"></script>

</head>

<!-- BODY STARTS -->
<body>

<div id="app" class="app">

<!-- MAIN: header + content -->
<main class="content" id="main-content">
  <div class="page-container">
  <h1 class="page-title">An√°lises</h1>
  <p class="page-subtitle">Visualize m√©tricas e tend√™ncias do atendimento ao cliente</p>

  <!-- KPI Cards -->
  <section aria-label="KPIs" class="kpi-grid" role="region">
    <div class="kpi-card">
      <p class="kpi-label">Volume Total</p>
      <p class="kpi-value"><%= Conversation.count %></p>
      <p class="kpi-delta kpi-delta--up">+12% vs. semana anterior</p>
    </div>

    <div class="kpi-card">
      <p class="kpi-label">Taxa de Resolu√ß√£o</p>
      <p class="kpi-value">88.5%</p>
      <p class="kpi-delta kpi-delta--up">+3.2% vs. semana anterior</p>
    </div>

    <div class="kpi-card">
      <p class="kpi-label">Tempo M√©dio</p>
      <p class="kpi-value">8.2 min</p>
      <p class="kpi-delta kpi-delta--down">+1.5 min vs. semana anterior</p>
    </div>

    <div class="kpi-card">
      <p class="kpi-label">Satisfa√ß√£o</p>
      <p class="kpi-value">4.6 / 5.0</p>
      <p class="kpi-delta kpi-delta--up">+0.2 vs. semana anterior</p>
    </div>
  </section>

  <!-- Pareto / 80-20 analysis -->
  <section class="section-card" aria-labelledby="pareto-title">
    <h2 id="pareto-title">An√°lise de Foco 80/20 (Princ√≠pio de Pareto)</h2>
    <p class="muted">Identifique os poucos problemas (20%) que geram a maior parte do volume (80%)</p>

    <div class="pareto-callout">
      <p class="pareto-callout__title">
        <strong>üí° Insight:</strong>
        Focar nos seguintes problemas resolver√°
        <strong><%= @pareto.last.cum_pct.to_i %>%</strong> do volume total
      </p>

      <ul class="pareto-list">
        <% @pareto.each do |item| %>
          <li class="pareto-list__item">
            <strong><%= item.tag %></strong>:
            <%= item.pct.to_i %>% do volume total
            <span class="muted">(<%= item.cum_pct.to_i %>% cumulativo)</span>
          </li>
        <% end %>
      </ul>
    </div>

    <div id="classificationChart" class="chart-wrap">
      <%= render "shared/charts_paretto" %>
    </div>
  </section>

  <!-- Top issues list -->
  <section class="section-card problems-section" aria-labelledby="top-issues-title">
    <h3 id="top-issues-title" class="problems-section__title">Principais Problemas</h3>
    <p class="problems-section__subtitle">T√≥picos em alta que precisam de aten√ß√£o</p>

    <div class="problems-list" role="list">
      <% @pareto.each_with_index do |item, i| %>
        <%= render partial: "shared/trend_card", locals: { item: item, index: i + 1 } %>
      <% end %>
    </div>
  </section>

  <div class="page-footer">
    <%= link_to "‚¨Ö Back to Conversations", root_path, class: "back-link" %>
  </div>
  </div>
</main>
</div>
</div>


</body>
</html>
